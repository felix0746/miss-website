<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文章 - 覓食 MISS</title>
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="stylesheet" href="css/style.css">
    <!-- Font Awesome Icon Library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Firebase SDKs - 使用最新穩定版本 -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body>
    <header id="main-header">
        <!-- 頁首內容將由 script.js 動態載入 -->
    </header>

    <main>
        <section class="post-full-content">
            <div class="container">
                 <div class="post-content-container" id="post-content-container">
                    <!-- 文章內容將由 JavaScript 動態載入 -->
                </div>
            </div>
        </section>
    </main>

    <div id="footer-placeholder"></div>
    
    <script>
        // --- Post ID Resolution Logic ---
        // This script runs before the main 'script.js' to determine the post ID from the URL.
        // It supports both new static-like URLs (e.g., /posts/post-id.html) and legacy query URLs (e.g., /post.html?id=post-id).
        (function() {
            try {
                const path = window.location.pathname;
                const searchParams = new URLSearchParams(window.location.search);
                let postId = null;

                // 1. Try to extract from a static-like path first (e.g., /posts/some-id.html)
                const staticMatch = path.match(/^\/posts\/(.+)\.html$/);
                if (staticMatch && staticMatch[1]) {
                    postId = staticMatch[1];
                }

                // 2. If not found, fall back to the legacy query parameter (e.g., ?id=some-id)
                if (!postId && searchParams.has('id')) {
                    postId = searchParams.get('id');
                }

                if (postId) {
                    console.log(`Resolved post ID: ${postId}`);
                    // Store the resolved post ID on the window object so it can be accessed by script.js
                    window.postId = postId;
                } else {
                    console.warn("Could not resolve post ID from URL.");
                }
            } catch (error) {
                console.error("Error resolving post ID:", error);
            }
        })();
    </script>
    <script src="script.js" type="module"></script>
</body>
</html>